<!doctype html>
<html lang="en">
  <head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <title>Work1: JQury+Bootstrap Matching Game</title>
    <style>
        #view2 img{
          width: 50px;
          height: 190px;
        }
        #view2 .col {
          padding: 3px;
        }
        #view2 .col img {
          width:100%;
        }
</style>

  </head>
  <body>
    <h1 class="alert alert-primary text-center">งานที่ 1: เกมจับคู่ภาพ โดยใช้ Jquery และ Bootstrap</h1>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
   
    <div id='view1' class='text-center '>
        <button id="playBtn" type="button" class="btn btn-primary">เริ่มเล่นเกม</button>
        <a href="index.html" class="btn btn-danger">กลับหน้าหลัก</a>
    </div>

    <div id='view2' class='container '>
        <div class="row">
          <div class="col" ><img src='img/0.png' id='img1'></div>
          <div class="col" ><img src='img/0.png' id='img2'></div>
          <div class="col" ><img src='img/0.png' id='img3'></div>
          <div class="col" ><img src='img/0.png' id='img4'></div>
          <div class="col" ><img src='img/0.png' id='img5'></div>
          <div class="col" ><img src='img/0.png' id='img6'></div>
        </div>
        <div class="row">
          <div class="col" ><img src='img/0.png' id='img7'></div>
          <div class="col" ><img src='img/0.png' id='img8'></div>
          <div class="col" ><img src='img/0.png' id='img9'></div>
          <div class="col" ><img src='img/0.png' id='img10'></div>
          <div class="col" ><img src='img/0.png' id='img11'></div>
          <div class="col" ><img src='img/0.png' id='img12'></div>
        </div>
        <div class="row">
          <div class="col" ><img src='img/0.png' id='img13'></div>
          <div class="col" ><img src='img/0.png' id='img14'></div>
          <div class="col" ><img src='img/0.png' id='img15'></div>
          <div class="col" ><img src='img/0.png' id='img16'></div>
          <div class="col" ><img src='img/0.png' id='img17'></div>
          <div class="col" ><img src='img/0.png' id='img18'></div>
        </div>
        <button id="stopBtn" class="btn btn-danger">ออกจากเกม </button>
    </div>
    
    <div id="view3" class='text-center '>
      <h1 class="alert text-center">ยินดีด้วย คุณชนะแล้ว</h1>
      <div><button id="okBtn" class="btn btn-primary">ตกลง</button></div>
    </div>
      
  </div>
  <script>
    $(function(){
      $("#view2").hide();
      $("#view3").hide();
      $("#playBtn").click(startGame);
      $("#stopBtn").click(stopGame);
      $("#okBtn").click(goHome);
      $("#view2 img").click(imgClick);   
    });

    var cards_opened=[];
    var card_count=18;
    function imgClick(){
      if($(this).attr("src")!="img/0.png")return;

      if(cards_opened.length<2){
        var s=$(this).attr("srcx");
        $(this).attr("src",s);
        cards_opened.push(this);
        if(cards_opened.length==2){
          setTimeout(checkCard,1000);
        }
      }
      }

      function checkCard(){
        var a=cards_opened[0];
        var b=cards_opened[1];
        cards_opened=[];
        if($(a).attr("srcx")==$(b).attr("srcx")){
          $(a).hide();
          $(b).hide();
          card_count-=2;
        }else{
          $(a).attr("src","img/0.png");
          $(b).attr("src","img/0.png");
        }
        if(card_count==0){
          $("#view3").show();
          $("#view2").hide();
        }
      }

      function imgclick(){
        var s=$(this).attr("srcx");
        $(this).attr("src",s);
      }

    function startGame(){
      $("#view2").show();
      $("#view1").hide();
      cards_opened=[];
      card_count=18;
      shuffle();
    }
    function stopGame(){
      $("#view2").hide();
      $("#view1").show();
    }
    function goHome(){
      $("#view1").hide();
      $("#view3").show();
    }

    function shuffle(){
        var list=[];
        for (var i = 1; i <= 18; i++) {
          list.push(i);
          list.push(i);
        }
       // console.log(list);
        for(var i=1;i<100;i++){
          var a=Math.round(Math.random()*15);
          var b=Math.round(Math.random()*15);
          var t=list[a];
          list[a]=list[b];
          list[b]=t;
        }
        // console.log(list);
        for(var i=0;i<19;i++){
          $("#img"+(i+1)).attr("src","img/0.png");
          $("#img"+(i+1)).attr("srcx","img/"+list[i]+".png");
        }
      }
  </script>
  
  </body>
</html>